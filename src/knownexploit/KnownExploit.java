package knownexploit;

import java.util.ArrayList;
import java.util.Hashtable;
import java.util.Map;

import app.App;
import entrypoint.EntryPoint;
import sink.Sink;
import xml.XMLParser;

public abstract class KnownExploit {
	
	private ArrayList<String> _codeLines = new ArrayList<String>();
	protected Boolean _isSafe = true;
	
	protected String _vunerabilityIntel = "";
	protected String _vunerabilityType;
	
	protected ArrayList<EntryPoint> _eps = new ArrayList<EntryPoint>();
	protected EntryPoint _ep = null;

	protected ArrayList<Sink> _sinks = new ArrayList<Sink>();
	protected Sink _sink = null;
	
	protected XMLParser _xmlParser;
	
	protected Map<String, String> _querys = new Hashtable<String, String>();

	
	public KnownExploit(ArrayList<String> codeLines){

	}
	
	public KnownExploit(String fileName, ArrayList<String> codeLines, String vunerabilityType){
		_vunerabilityType = vunerabilityType;
		_codeLines = codeLines;
		App.getKnownExploits().add(this);
		_xmlParser = new XMLParser(fileName);
		doLogic();
	}
	
	protected abstract void doLogic();
	
	protected ArrayList<String> getCodeLines(){
		return _codeLines;
	}

	
	public abstract boolean testVunerability();
	
	
	public String getVunerabilityIntel(){
		return _vunerabilityIntel;
	}
}
